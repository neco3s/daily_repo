
## 取り組んだ課題一覧

- :memo: 日記 :tomato:1
- :deciduous_tree:(evergreen) typing,Linux,SQL :tomato:1
- :stars:(catch the moment) RailsでECサイトを作る :tomato:13

## わかったこと

- ホームディレクトリとは、現在ログインしているユーザ名を表示するコマンドが `echo $USER`で`cd ~`とするとホームディレクトリ、つまり管理されているユーザーの中の現在ログインしているユーザのディレクトリまで移動することになる`Users/neco3`みたいな感じ `pwd`で確認できる
- ルートディレクトリとは一番上の階層のディレクトリ、全てのディレクトリはルート(根)に通ずる `cd /`で移動できる。`pwd`で`/`と表示される
- add_foreign_keyメソッドはデータベースレベルでの関係性を定義し、データの整合性を保つために使用されます。一方、has_manyなどのアソシエーションはRailsアプリケーション内でのモデル間の関係性を表現し、データの操作や関連データへのアクセスを提供します。
- インデックス(本の目次)をカラムに対して作成することで、そのカラムを検索条件にしたときの検索が効率化される(パフォーマンスが高まる)、データの整合性が保たれる。①インデックスを作成することでDBMS君がそのカラムの値を基準にデータを整理しておくから、②インデックスはクエリオプティマイザが実行コストが最小となる実行計画を決定する際の判断材料になるから、③インデックスはデータベース内のデータの物理的な配置を指し示すため、必要なデータへのアクセスが高速化される、④DMBS君はインデックス(本の目次)を使用して、クエリの条件に一致するデータを直接特定する、つまり必要なデータのみを対象にした効率的な検索が可能になる 🚧インデックスがないとテーブル内の全てのレコードを順番にスキャン(シーケンシャルスキャン)しなければならない
- ユニーク制約をつけていない場合、DBMSはインデックスを使用して検索を行い条件に一致するレコードを見つけたとしても、一致する値が複数ある可能性を考慮して、テーブル内の全てのレコードをスキャンする(シーケンシャルスキャン,非効率)
- そのカラムで検索を行うならインデックスをまずは作成、そして値が重複しないのであればユニーク制約をつけるべし！
- ただし! データの更新(行の挿入・更新・削除)が発生した際にインデックスも更新する必要がある(オーバーヘッド)ため頻繁に更新される場合はインデックスによるオーバーヘッドが増えてしまう。またインデックスはディスクに保存されるため、ディスクスペースを占有する。トレードオフを考えてインデックスを作成するかどうかを判断すべし！
- インデックスが使われない時に何が起こっているのか。プランナーが効率が良い最適な判断を下している<https://devcenter.heroku.com/ja/articles/postgresql-indexes>
- PostgreSQLクエリ実行の基礎知識 <https://morizyun.github.io/blog/postgresql-index-planner-optimize/index.html>
- `add_foreign_key :articles, :authors`がどのようなSQL文を生成しているか、<https://api.rubyonrails.org/v7.0/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-add_foreign_key>
- `rails db:rollback`はl changeメソッドを逆転実行するかdownメソッドを実行する形で直前のマイグレーションにロールバックする。保守の観点からupとdownをどちらも整備するのは大変なのでchangeメソッドで記述してActive Recordがマイグレーションを自動で逆進させる(以前のバージョンに戻す)方法を自動的に認識してくれる。Railsガイドのchangeメソッドの項目に載っていないメソッドを使用する場合はchangeメソッドの代わりにreversibleメソッドかupとdownメソッドを明示的に記述する必要性がある。upはバージョンを上げる。downはバージョンを下げる。changeはバージョンを上げるコードだけが書かれているが、バージョンを下げる処理も適切に行なってくれる。🚧 データベースへの変更を取り消したい時はrollbackしてからマイグレーションファイルを削除すべし、先にマイグレーションファイルを削除してしまうと詰む(解決策はあるが面倒、もはや素直にgit reset --hard HEAD^とかでいいと思う)
- `rails g ...`で生成したファイル群は`rails d ...`で全て削除できる。
- 迷惑メールが来てそれがHTMLメールだった場合、透明な画像(webビーコン)がメーラーで表示され、それが送信者に伝わり、「あ、こいつ開いたな」ってバレるので、絶対に開く前に🗑️ゴミ箱に捨てるべし、なんなら迷惑メールとして報告する。 <https://www.hai2mail.jp/column/mail-knowhow/how-to-use-google-analytics.php#:~:text=%E9%85%8D%E4%BF%A1%E3%81%97%E3%81%9F%E3%83%A1%E3%83%BC%E3%83%AB%E3%81%8C%E9%96%8B,%E3%82%88%E3%81%86%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82>
- 基本的にRailsでは複合キーは許されていない。複合キーを使う場合はcomposite_primary_keysというGemを使う
- Railsではデフォルトでidカラムにインデックスが作成されますが、主キーの一意性制約は自動的には設定されません。一意性制約を明示的に設定する必要があります。
- `rails db:migrate`ではマイグレーションファイルの上から実行されるので、購入テーブルと購入詳細テーブルを繋げる購入詳細関連テーブルの３つがあった場合、購入詳細関連テーブルは購入テーブルと購入詳細テーブルが作成された後に作成される必要がある(２つのテーブルのidをFK として持つため)のでファイルの一番したに記述すべし


## 次やること

- :deciduous_tree:(evergreen) typing,Linux,SQL,algorithm :tomato:1
- :memo:(mind) 日記(昨日の振り返り、今日取り組むこと、昨日を踏まえて、今日はどんな気持ちで過ごしたいか言葉にする) :tomato:1

- Railsチュートリアル7版(Ruby on Rails5速習実践ガイドの代わり) 8:tomato: (13)
- RailsでECサイトを作る 51:tomato:
- Rails課題をやる(twitter clone) 120:tomato:
- テスト技法について学ぶ 10:tomato:
- Everyday Rails - RSpecによるRailsテスト入門 21:tomato:
- 自動テスト 15:tomato:
- 米国AI開発者がゼロから教えるDocker講座(CI/CD) | Udemy 20:tomato:
- :compass: 自作サービス作成までに何をやって何をやらないのかを明確にする 3~5:tomato:

- 達人に学ぶDB設計 徹底指南書を読む、記事作成、URL提出 16:tomato:
- twitterER図のブラッシュアップ

## 感じたこと

- RailsのActiveRecordは規約を守ればよしなにやってくれるが、実態はSQL文なのでどう記述すればいいかだけでなく生成されるSQL文も合わせて見ることでようやく不安なく記述できるなと感じた
- Railsガイドすごくありがたいです、整備してくれてる人に感謝
- railsのcontributorの方は6000人くらいいることに驚いた
- 1人でrailsに10000commitしている人がいてバケモンだなと感じた

## 学習時間

- Today：7h
- Total：203h
